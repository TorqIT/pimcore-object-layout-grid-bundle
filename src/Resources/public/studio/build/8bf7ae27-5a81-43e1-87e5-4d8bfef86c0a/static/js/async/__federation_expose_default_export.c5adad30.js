"use strict";(self.webpackChunktorq_object_layout_grid_bundle=self.webpackChunktorq_object_layout_grid_bundle||[]).push([["525"],{4934:function(e,t,r){r.r(t),r.d(t,{ObjectLayoutGridPlugin:()=>I});var a=r(2977),o=r(4781),i=r(1556),n=r.n(i),s=r(4848),l=r(2462),d=r(9274),u=r(5085),c=r(6264),p=r(1838),m=r(3449),g=r(2559),y=r(3842);let h="Custom Report",b=e=>{let{name:t}=e,{openElement:r}=(0,y.useElementHelper)(),{id:a}=(0,y.useElementContext)(),[o,n]=(0,i.useState)([]),[b,j]=(0,i.useState)(!1),[x,I]=(0,i.useState)(""),R={title:e.title,style:e.style,height:e.height,width:e.width,gridDataType:e.gridDataType,apiDataUrl:e.apiDataUrl,customReportName:e.customReportName,customReportFilterByObjectId:e.customReportFilterByObjectId,customReportFilterIndexName:e.customReportFilterIndexName,columns:e.columns||[]},S=(0,i.useMemo)(()=>R.columns?[...R.columns].sort((e,t)=>e.position-t.position).map(e=>{let t={title:e.label,dataIndex:e.dataIndex,key:e.dataIndex,sorter:(t,r)=>{let a=t[e.dataIndex],o=r[e.dataIndex];if(a===o)return 0;if(null==a)return 1;if(null==o)return -1;let i=Number(a),n=Number(o);return isNaN(i)||isNaN(n)?String(a).localeCompare(String(o)):i-n},defaultSortOrder:"ASC"===e.sortDirection?"ascend":"DESC"===e.sortDirection?"descend":void 0};return e.openObject?{...t,width:100,sorter:!1,render:(t,a)=>(0,s.jsx)(l.Ay,{type:"link",icon:(0,s.jsx)(m.A,{}),title:"Open Object",onClick:async()=>{let o=t||a[e.dataIndex]||a.id;o&&await r({id:Number(o),type:"data-object"})}})}:t}):[],[R.columns,r]),N=(0,i.useMemo)(()=>x?o.filter(e=>Object.values(e).some(e=>String(e).toLowerCase().includes(x.toLowerCase()))):o,[o,x]);(0,i.useEffect)(()=>{if(!R.gridDataType)return;j(!0);let e="";if(R.gridDataType===h?e="/admin/bundle/objectlayoutgrid/get-report-data":"API"===R.gridDataType&&(e=R.apiDataUrl||""),!e)return void j(!1);let r=new URLSearchParams({objectId:String(a||""),gridLayoutFieldName:t||""});R.gridDataType===h&&(R.customReportName&&r.append("customReportName",String(R.customReportName)),void 0!==R.customReportFilterByObjectId&&r.append("customReportFilterByObjectId",String(R.customReportFilterByObjectId)),R.customReportFilterIndexName&&r.append("customReportFilterIndexName",String(R.customReportFilterIndexName))),fetch(`${e}?${r.toString()}`,{method:"GET",headers:{"Content-Type":"application/json"}}).then(e=>{if(!e.ok)throw Error(`HTTP error! status: ${e.status}`);return e.json()}).then(e=>{n(e.data||[]),j(!1)}).catch(e=>{console.error("Error loading grid data:",e),d.Ay.error(`Failed to load grid data: ${e.message}`),j(!1)})},[R.gridDataType,R.apiDataUrl,R.customReportName,R.customReportFilterByObjectId,R.customReportFilterIndexName,a,t]);let w={margin:"10px 0",...R.height&&{height:R.height},...R.width&&{width:R.width}};return(0,s.jsx)(u.A,{title:R.title||"Grid Layout",style:w,extra:(0,s.jsx)(c.A,{placeholder:"Search...",prefix:(0,s.jsx)(g.A,{}),value:x,onChange:e=>I(e.target.value),style:{width:200}}),children:(0,s.jsx)(p.A,{columns:S,dataSource:N,loading:b,pagination:{defaultPageSize:100,showSizeChanger:!0,showQuickJumper:!0,showTotal:(e,t)=>`${t[0]}-${t[1]} of ${e} items`,pageSizeOptions:["50","100","200","500","1000"]},size:"small",rowKey:(e,t)=>e.data||t||0,scroll:{y:400}})})};class j{getObjectLayoutComponent(e){return n().createElement(b,e)}constructor(){this.id="grid"}}let x={onInit(){let e=a.container.get(o.serviceIds["DynamicTypes/ObjectLayoutRegistry"]),t=new j;e.registerDynamicType(t)}},I={name:"ObjectLayoutGridPlugin",onStartup(e){let{moduleSystem:t}=e;t.registerModule(x)}}}}]);